# doc-reader 文档阅读工具

<tool>
  <purpose>
## 核心问题定义
读取Microsoft Word .doc格式文件的内容，解决非.docx格式老旧文档的查看困难问题。

## 价值主张

- 🎯 **解决兼容性痛点**：无需安装 Microsoft Office 即可查看.doc 文档
- 🚀 **提高工作效率**：快速提取.doc 文档内容，支持批处理
- 🌟 **独特优势**：自动处理编码问题，优化中文文档显示

## 应用边界

- ✅ **适用场景**：查看旧版 Word 文档、批量提取.doc 内容、处理不便打开的文档
- ❌ **不适用场景**：处理复杂格式内容(如表格和图片)、需要保留原始格式的场景
  </purpose>

  <usage>

## 使用时机

- 需要快速查看.doc 文档内容而无需打开 Word
- 批量处理多个.doc 文档提取文本
- 在不支持.doc 编辑的环境中查看文档内容

## 操作步骤

1. **准备阶段**：确保系统已安装 antiword 工具 (`brew install antiword`)
2. **执行阶段**：
   - 调用工具并提供文档路径
   - 可选指定编码参数(默认自动检测)
3. **验证阶段**：检查返回的文本内容是否完整可读

## 最佳实践

- 🎯 **中文文档**：对于中文文档，如遇乱码可尝试手动指定编码为'gbk'或'gb2312'
- ⚠️ **路径处理**：文件路径中如有空格，工具会自动处理引号，无需特殊处理
- 🔧 **故障排除**：如遇失败，请检查 antiword 是否正确安装及文件是否真为.doc 格式

## 注意事项

- 仅提取文本内容，不包括文档内的图片、表格格式等
- 文件必须是真正的.doc 格式，非.docx 重命名而来
- 大型文档可能需要较长处理时间，请耐心等待
  </usage>

  <parameter>

## 必需参数

| 参数名   | 类型   | 描述            | 示例                    |
| -------- | ------ | --------------- | ----------------------- |
| filePath | string | .doc 文件的路径 | "/path/to/document.doc" |

## 可选参数

| 参数名   | 类型   | 默认值 | 描述                                           |
| -------- | ------ | ------ | ---------------------------------------------- |
| encoding | string | "auto" | 指定文档编码，可选值如"utf-8"、"gbk"、"gb2312" |

## 参数约束

- **文件格式**：仅支持.doc 文件格式，不支持.docx
- **路径要求**：需提供有效的文件系统路径
- **编码选项**：当自动检测失败时可手动指定

## 参数示例

```json
{
  "filePath": "/Users/username/Documents/example.doc",
  "encoding": "auto"
}
```

  </parameter>

  <outcome>
## 成功返回格式
```json
{
  "success": true,
  "data": {
    "content": "文档的文本内容...",
    "metadata": {
      "fileName": "example.doc",
      "fileSize": 25600,
      "processingTime": 235
    }
  }
}
```

## 错误处理格式

```json
{
  "success": false,
  "error": {
    "code": "FILE_NOT_FOUND",
    "message": "文件 '/path/to/document.doc' 不存在"
  }
}
```

## 可能的错误代码

- **FILE_NOT_FOUND**: 找不到指定文件
- **TOOL_NOT_FOUND**: 未安装 antiword 工具
- **PROCESSING_ERROR**: 文档处理过程中的错误
- **EXECUTION_ERROR**: 工具执行过程中的一般错误

## 结果解读指南

- **如何判断执行成功**：检查返回对象的`success`字段是否为`true`
- **如何获取文档内容**：从`data.content`字段获取文本内容
- **如何处理编码问题**：如遇乱码，尝试指定具体编码重新调用

## 后续动作建议

- 获取内容后可进行文本分析或格式转换
- 对于大型文档，考虑分段处理以提高效率
- 批处理多个文档时，可循环调用本工具
  </outcome>
  </tool>
