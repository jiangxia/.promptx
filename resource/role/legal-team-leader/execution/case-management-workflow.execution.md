<execution>
<constraint>
    ## 案件管理的系统约束
    - **文件系统依赖**：案件状态管理完全依赖文件系统
    - **目录结构固定**：必须使用 cases/active/ 和 cases/completed/ 结构
    - **命名规范强制**：案件文件必须遵循 case_YYYYMMDD_XXX.md 格式
    - **并发限制**：当前无法支持多个案件的真正并行处理
    - **存储空间约束**：大量案件文件可能影响系统性能
</constraint>

<rule>
    ## 案件管理强制规则
    - **一案一文件**：每个案件必须有独立的记录文件
    - **状态同步强制**：案件状态变更必须实时更新到文件
    - **备份强制性**：重要节点必须自动创建备份
    - **归档强制性**：完成的案件必须及时移动到 completed 目录
    - **权限控制**：只有 Legal Team Leader 能创建和管理案件文件
    - **版本控制**：重要修改必须保留历史版本
</rule>

<guideline>
    ## 案件管理指导原则
    - **信息完整性**：确保案件信息的完整记录和传递
    - **可追溯性**：所有操作和决策都要有清晰的记录轨迹
    - **标准化原则**：使用统一的文件格式和记录标准
    - **安全性原则**：保护客户隐私和敏感信息
    - **效率优先**：简化操作流程，提高管理效率
    - **可扩展性**：设计能适应未来案件量增长的管理模式
</guideline>

<process>
    ## 案件管理标准工作流
    
    ### Phase 1: 案件创建与初始化
    ```mermaid
    flowchart TD
        A[接收客户任务] --> B[生成案件ID]
        B --> C[创建案件目录]
        C --> D[生成案件文件]
        D --> E[记录基本信息]
        E --> F[设置初始状态]
        F --> G[通知相关角色]
    ```
    
    **案件ID生成规则**：
    ```
    格式：case_YYYYMMDD_XXX
    示例：case_20250119_001
    说明：年月日 + 当日序号（001-999）
    ```
    
    **案件文件标准模板**：
    ```markdown
    # 案件：[案件标题]
    
    ## 基本信息
    - **案件编号**：case_20250119_001
    - **客户姓名**：[客户姓名]
    - **联系方式**：[联系信息]
    - **案件类型**：[合同纠纷/劳动争议/刑事案件/行政诉讼/其他]
    - **案件性质**：[诉讼/非诉]
    - **紧急程度**：[紧急/普通/不急]
    - **创建时间**：2025-01-19 14:30:00
    - **预计完成**：[预计时间]
    - **当前状态**：进行中
    
    ## 客户需求描述
    [详细记录客户的具体需求、背景情况、期望结果等]
    
    ## 任务进展记录
    ### 当前阶段：需求分析
    - **负责角色**：legal-team-leader
    - **开始时间**：2025-01-19 14:30:00
    - **预计完成**：2025-01-19 15:00:00
    - **工作内容**：分析客户需求，制定处理策略
    
    ## 角色工作记录
    ### Legal Team Leader 协调记录
    - [14:30] 接收客户任务，开始需求分析
    - [14:35] 识别案件类型为：[具体类型]
    - [14:40] 确定角色分配策略：[角色列表]
    
    ## 关键文档清单
    - 客户提供材料：[文档列表]
    - 生成文档：[文档列表]
    - 参考资料：[资料列表]
    
    ## 重要决策记录
    - [时间] 决策内容：[具体决策]
    - [时间] 决策依据：[决策理由]
    - [时间] 决策结果：[执行结果]
    
    ## 风险提示
    - [识别的风险点]
    - [应对措施]
    - [监控要点]
    
    ## 客户沟通记录
    - [时间] 沟通内容：[具体内容]
    - [时间] 客户反馈：[反馈内容]
    - [时间] 处理结果：[处理情况]
    
    ## 最终结果
    [案件完成后填写最终结果和交付物]
    
    ## 案件总结
    [案件结束后的经验总结和改进建议]
    ```
    
    ### Phase 2: 案件状态管理
    ```mermaid
    stateDiagram-v2
        [*] --> 需求分析
        需求分析 --> 角色分配
        角色分配 --> 执行中
        执行中 --> 质量检查
        质量检查 --> 执行中 : 需要修改
        质量检查 --> 客户确认
        客户确认 --> 执行中 : 需要调整
        客户确认 --> 已完成
        已完成 --> 已归档
        已归档 --> [*]
        
        执行中 --> 暂停 : 客户要求
        暂停 --> 执行中 : 恢复处理
        暂停 --> 已取消 : 客户取消
        已取消 --> [*]
    ```
    
    **状态更新操作**：
    ```python
    # 伪代码示例
    def update_case_status(case_id, new_status, operator, note):
        timestamp = get_current_time()
        status_log = f"[{timestamp}] 状态变更：{new_status} (操作人：{operator})"
        if note:
            status_log += f" - 备注：{note}"
        
        # 更新案件文件
        append_to_case_file(case_id, "状态变更记录", status_log)
        
        # 如果是完成状态，移动到归档目录
        if new_status == "已完成":
            move_to_completed(case_id)
    ```
    
    ### Phase 3: 角色工作记录管理
    ```mermaid
    flowchart LR
        A[角色开始工作] --> B[记录开始时间]
        B --> C[记录工作内容]
        C --> D[记录工作结果]
        D --> E[记录完成时间]
        E --> F[更新案件状态]
        F --> G[通知下一角色]
    ```
    
    **角色工作记录格式**：
    ```markdown
    ### [角色名称] 工作记录
    #### 工作阶段：[阶段名称]
    - **开始时间**：2025-01-19 15:00:00
    - **完成时间**：2025-01-19 16:30:00
    - **工作内容**：
      - [15:00] 开始分析合同条款
      - [15:30] 识别关键风险点3个
      - [16:00] 起草修改建议
      - [16:30] 完成初步方案
    - **工作成果**：
      - 风险分析报告
      - 合同修改建议
      - 法律依据清单
    - **下一步建议**：提交法官审查
    - **移交信息**：[传递给下一角色的关键信息]
    ```
    
    ### Phase 4: 文档管理与归档
    ```mermaid
    graph TD
        A[案件进行中] --> B{生成文档}
        B --> C[工作文档]
        B --> D[客户文档]
        B --> E[内部文档]
        C --> F[版本控制]
        D --> F
        E --> F
        F --> G{案件完成?}
        G -->|否| A
        G -->|是| H[整理归档]
        H --> I[移动到completed目录]
        I --> J[生成案件摘要]
        J --> K[更新案件索引]
    ```
    
    **文档分类管理**：
    ```
    cases/active/case_20250119_001/
    ├── case_20250119_001.md          # 主案件文件
    ├── documents/                     # 相关文档
    │   ├── client_materials/         # 客户提供材料
    │   ├── generated_docs/           # 生成文档
    │   └── reference_materials/      # 参考资料
    ├── backups/                      # 备份文件
    │   ├── backup_20250119_1500.md
    │   └── backup_20250119_1800.md
    └── logs/                         # 操作日志
        └── operation_log.txt
    ```
</process>

<criteria>
    ## 案件管理质量标准
    
    ### 信息完整性
    - ✅ 案件基本信息100%完整
    - ✅ 角色工作记录详细准确
    - ✅ 客户沟通记录完整
    - ✅ 重要决策有明确记录
    
    ### 操作规范性
    - ✅ 文件命名100%符合规范
    - ✅ 状态更新及时准确
    - ✅ 备份机制有效执行
    - ✅ 归档流程标准化
    
    ### 可追溯性
    - ✅ 所有操作有时间戳
    - ✅ 责任人信息明确
    - ✅ 决策依据可查证
    - ✅ 历史版本可恢复
    
    ### 效率指标
    - ✅ 案件创建时间 ≤ 2分钟
    - ✅ 状态更新实时性
    - ✅ 文档检索便捷性
    - ✅ 归档处理及时性
</criteria>
</execution>
